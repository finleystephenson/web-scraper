---
phase: 03-deployment
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [Procfile, fly.toml]
autonomous: false
---

<objective>
Configure and deploy the Flask scraper to Fly.io.

Purpose: Complete the learning goal - get a working deployment on Fly.io with zero post-deploy setup.
Output: Live application accessible via Fly.io URL.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-scraping/02-01-SUMMARY.md

@app.py
@requirements.txt
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Procfile for gunicorn</name>
  <files>Procfile</files>
  <action>
Create Procfile in project root with:
```
web: gunicorn app:app
```

This tells Fly.io how to run the Flask app in production using gunicorn (already in requirements.txt).

No port binding needed - Fly.io sets PORT env var and gunicorn binds to 0.0.0.0:$PORT by default.
  </action>
  <verify>cat Procfile shows "web: gunicorn app:app"</verify>
  <done>Procfile exists with correct gunicorn command</done>
</task>

<task type="auto">
  <name>Task 2: Deploy to Fly.io</name>
  <files>fly.toml</files>
  <action>
Deploy using Fly.io CLI:

1. Run `fly launch --yes --copy-config --name lead-xray` to:
   - Auto-detect Python app
   - Generate fly.toml configuration
   - Create the app on Fly.io
   - Deploy

If `fly launch` fails with auth error:
- Stop and create auth gate checkpoint
- User runs `fly auth login`
- Retry deployment

The --yes flag accepts defaults. If app name taken, try with timestamp suffix.

After successful deploy, capture the app URL (format: https://lead-xray.fly.dev or similar).
  </action>
  <verify>`fly status` shows app running, `curl https://{app-name}.fly.dev` returns 200</verify>
  <done>App deployed to Fly.io, accessible via public URL</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Flask scraper deployed to Fly.io</what-built>
  <how-to-verify>
    1. Visit the deployed URL (shown in deploy output)
    2. Verify: Homepage loads with "Lead X-Ray" heading and form
    3. Test: Enter https://example.com and click Scan
    4. Confirm: SEO vitals display (title, H1, meta description)
    5. Check: No errors in the deployed app
  </how-to-verify>
  <resume-signal>Type "approved" if deployment works, or describe any issues</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Procfile exists with `web: gunicorn app:app`
- [ ] fly.toml exists (generated by fly launch)
- [ ] `fly status` shows app as running
- [ ] App accessible via public Fly.io URL
- [ ] Scraping functionality works on deployed app
</verification>

<success_criteria>
- All tasks completed
- App deployed and running on Fly.io
- User verified deployment works end-to-end
- No manual setup required after deployment
</success_criteria>

<output>
After completion, create `.planning/phases/03-deployment/03-01-SUMMARY.md`
</output>
